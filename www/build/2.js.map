{"version":3,"sources":["../../src/pages/location/location.module.ts","../../src/pages/location/location.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LocationPage } from './location';\n\n\n@NgModule({\n  declarations: [\n    LocationPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LocationPage),\n  ],\n})\nexport class LocationPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/location/location.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Geolocation } from '@ionic-native/geolocation';\nimport { trigger, state, style, transition, animate, group } from '@angular/animations';\n\nimport { TouristParams } from './../../interfaces/touristParams.interface';\n\n\n\nimport {\n  GoogleMaps,\n  GoogleMap,\n  GoogleMapsEvent,\n  LatLng,\n  CameraPosition,\n  MarkerOptions,\n  Marker\n} from '@ionic-native/google-maps';\n\nconst locationStorageKey = \"locationStorageKey\";\n\n@IonicPage()\n@Component({\n  selector: 'page-location',\n  templateUrl: 'location.html',\n  animations: [\n    trigger('popupAnim', [\n      state('void', style({ opacity: 0 })),\n      transition(':enter', [\n        animate('0.25s', style({\n          opacity: 1,\n        }))\n      ]),\n      transition(':leave', [\n        animate('0.25s', style({\n          opacity: 0,\n        }))\n\n      ])\n    ])\n  ]\n})\nexport class LocationPage {\n  map: GoogleMap;\n  gspIsLoading: boolean = false;\n  marker: Marker = null;\n  lat: string = null;\n  lng: string = null;\n\n  tp: TouristParams = null;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, private googleMaps: GoogleMaps, private geolocation: Geolocation) {\n    this.tp = navParams.data;\n  }\n\n  ionViewDidLoad() {\n    this.marker = null;\n\n    console.log('ionViewDidLoad LocationPage');\n    this.loadMap();\n  }\n\n  nextPage() {\n    if (this.lat != null) {\n      this.tp.lat = this.lat;\n      this.tp.lng = this.lng\n\n      this.navCtrl.push(\"NamePage\", this.tp);\n\n    }\n    else {\n      alert(\"you need to add a location in order to procede\")\n    }\n\n  }\n\n  getLocation() {\n    console.log(\"getting location....\");\n    this.gspIsLoading = true;\n\n    this.geolocation.getCurrentPosition().then((pos) => {\n      this.gspIsLoading = false;\n      this.setAndZoomMarker(pos.coords.latitude, pos.coords.longitude);\n\n    }).catch((error) => {\n      this.gspIsLoading = false;\n\n      console.log('Error getting location', error);\n      //PositionError {code: 1, message: \"Illegal Access\"}\n      //TODO handle this\n      alert(\"impossible get the location.\");\n    });\n  }\n\n\n  cancelGPS() {\n    //TODO stop getting gps\n    this.gspIsLoading = false;\n\n  }\n\n  loadMap() {\n\n\n    // create a new map by passing HTMLElement\n    let element: HTMLElement = document.getElementById('map');\n\n    this.map = this.googleMaps.create(element);\n\n    // listen to MAP_READY event\n    // You must wait for this event to fire before adding something to the map or modifying it in anyway\n    this.map.one(GoogleMapsEvent.MAP_READY).then(() => {\n      console.log('Map is ready!');\n\n      this.map.addMarker({\n        icon: {\n          url: 'assets/img/blueMarker.png',\n          anchor: [15, 42],\n          size: {\n            width: 31,\n            height: 42\n          }\n        },\n        visible: false,\n        draggable: false,\n        disableAutoPan: true,\n        position: {\n          lat: 0,\n          lng: 0\n        }\n      }).then((marker: Marker) => {\n        this.marker = marker;\n        this.listenToClickEvent();\n\n      });\n\n\n\n      //Set true if you want to show the MyLocation button\n      this.map.setMyLocationEnabled(true);\n\n      // create CameraPosition\n      let position: CameraPosition = {\n        target: {\n          lat: 46.948212,\n          lng: 8.303241\n        },\n        zoom: 7,\n        tilt: 0\n      };\n      // move the map's camera to position\n      this.map.moveCamera(position);\n      this.getLocation();\n    }\n    );\n\n  }\n\n  listenToClickEvent() {\n    this.map.on(GoogleMapsEvent.MAP_CLICK).subscribe(\n      (latLng) => {\n        this.setAndZoomMarker(latLng.lat, latLng.lng);\n      }\n    );\n    /*\n    declare var plugin: any;\n\n    this.map.on(plugin.google.maps.event.MAP_CLICK).subscribe(\n      (data) => {\n        console.log(\"Click MAP2\");\n        console.log(data);\n\n      }\n    );*/\n  }\n\n  setAndZoomMarker(lat, lng) {\n    this.lat = lat;\n    this.lng = lng;\n\n    localStorage.setItem(locationStorageKey, JSON.stringify({\n      lat: lat,\n      lng: lng\n    }));\n    this.marker.setPosition({\n      lat: lat,\n      lng: lng\n    });\n    this.marker.setVisible(true);\n\n    let position: CameraPosition = {\n      target: {\n        lat: lat,\n        lng: lng\n      },\n      zoom: 16,\n      duration: 1000,\n    };\n    // move the map's camera to position\n    this.map.animateCamera(position);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/location/location.ts"],"sourceRoot":""}